{% capture site_categories %}{% for category in site.categories %}{{ category | first | join: "/" }}{% unless forloop.last %},{% endunless %}{% endfor %}{% endcapture %}
{% assign category_words = site_categories | split:',' | sort %}

<section>
  <h2><a href="{{ root_url }}/{{ site.category_dir}}">Categories</a></h2>
  <ul>
    {% for item in (0..site.categories.size) %}
	{% unless forloop.last %}
		{% capture this_word %}{{ category_words[item] | strip_newlines }}{% endcapture %}
		<a href="{{ root_url }}/{{ site.category_dir }}#{{ this_word | cgi_escape }}-ref" rel="nofollow"><li><i class="icon-link"></i>{{ this_word }} ({{ site.categories[this_word].size }})
		</li></a>
    {% endunless %}
	{% endfor %}
  </ul>
</section>
